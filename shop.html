<!DOCTYPE html>
<html>
<head>
<title>Mecknown Shop</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>

<link rel="stylesheet" href="style.css">
</head>

<body>

<section class="section">

<h2>Mecknown Shop</h2>

<div id="loginSection">
  <button onclick="googleLogin()">Sign in with Google</button>
</div>

<div id="shopSection" style="display:none;">
  <p id="userInfo"></p>

  <h3>Robotics Kit</h3>
  <p>â‚¹2999</p>

  <input type="number" id="quantity" placeholder="Quantity">
  <button onclick="placeOrder()">Place Order</button>
  <br><br>
  <button onclick="logout()">Logout</button>
</div>

</section>

<script>

/* ðŸ”¥ PASTE YOUR FIREBASE CONFIG HERE */
const firebaseConfig = {
  apiKey: "AIzaSyDyh1Bi_29TpEG-_N3QijtxB7rdjLdHy3M",
  authDomain: "mecknownshop.firebaseapp.com",
  projectId: "mecknownshop"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

/* Google Login */
function googleLogin(){
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider);
}

/* Detect Login */
auth.onAuthStateChanged(user => {
  if(user){
    document.getElementById("loginSection").style.display="none";
    document.getElementById("shopSection").style.display="block";
    document.getElementById("userInfo").innerText =
      "Logged in as: " + user.email;
  }
});

/* Logout */
function logout(){
  auth.signOut();
  document.getElementById("shopSection").style.display="none";
  document.getElementById("loginSection").style.display="block";
}

/* Place Order â†’ Google Sheets */
function placeOrder(){

  const quantity = document.getElementById("quantity").value;
  const user = auth.currentUser;

  if(!user){
    alert("Please login first");
    return;
  }

  const formData = new FormData();
  formData.append("email", user.email);
  formData.append("product", "Robotics Kit");
  formData.append("quantity", quantity);

  fetch("https://script.google.com/macros/s/AKfycbxBF5aO2yATBlOWeWatWSWM_wlSk0i13DEBbRCtcUO5vYpwM6oH89BbwSrVzl1VVfR2kQ/exec", {
    method: "POST",
    body: formData
  })
  .then(() => alert("Order placed successfully!"))
  .catch(() => alert("Order failed"));

}

</script>

</body>
</html>
